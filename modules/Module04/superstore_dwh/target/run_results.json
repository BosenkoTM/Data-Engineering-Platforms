{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-23T18:01:51.377006Z", "invocation_id": "0b3c96f5-c80e-4e7c-9f7d-f930b1125e6c", "invocation_started_at": "2025-09-23T18:01:50.537192Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.257059Z", "completed_at": "2025-09-23T18:01:51.260420Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.261001Z", "completed_at": "2025-09-23T18:01:51.261016Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005999326705932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.superstore_dwh.stg_orders", "compiled": true, "compiled_code": "-- models/staging/stg_orders.sql\n-- \u042d\u0442\u0430 \u043c\u043e\u0434\u0435\u043b\u044c \u0447\u0438\u0442\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b stg.orders,\n-- \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u0442 \u0438\u0445 \u043a \u043d\u0443\u0436\u043d\u044b\u043c \u0442\u0438\u043f\u0430\u043c \u0438 \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043e\u0448\u0438\u0431\u043a\u0443 \u0441 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u043c \u043a\u043e\u0434\u043e\u043c.\n-- \u0412\u0441\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0431\u0443\u0434\u0443\u0442 \u0441\u0441\u044b\u043b\u0430\u0442\u044c\u0441\u044f \u043d\u0430 \u044d\u0442\u0443, \u0430 \u043d\u0435 \u043d\u0430 \u0438\u0441\u0445\u043e\u0434\u043d\u0443\u044e \u0442\u0430\u0431\u043b\u0438\u0446\u0443.\n\nSELECT\n    -- \u041f\u0440\u0438\u0432\u043e\u0434\u0438\u043c \u0432\u0441\u0435 \u043a \u043d\u0438\u0436\u043d\u0435\u043c\u0443 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0443 \u0434\u043b\u044f \u043a\u043e\u043d\u0441\u0438\u0441\u0442\u0435\u043d\u0442\u043d\u043e\u0441\u0442\u0438 \u0432 dbt\n    \"order_id\",\n    (\"order_date\")::date as order_date,\n    (\"ship_date\")::date as ship_date,\n    \"ship_mode\",\n    \"customer_id\",\n    \"customer_name\",\n    \"segment\",\n    \"country\",\n    \"city\",\n    \"state\",\n    -- \u0418\u0441\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0441 Burlington \u043f\u0440\u044f\u043c\u043e \u0437\u0434\u0435\u0441\u044c, \u043e\u0434\u0438\u043d \u0440\u0430\u0437 \u0438 \u043d\u0430\u0432\u0441\u0435\u0433\u0434\u0430\n    CASE\n        WHEN \"city\" = 'Burlington' AND \"postal_code\" IS NULL THEN '05401'\n        ELSE \"postal_code\"\n    END as postal_code,\n    \"region\",\n    \"product_id\",\n    \"category\",\n    \"subcategory\" as sub_category, -- \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u044b\u0432\u0430\u0435\u043c \u0434\u043b\u044f \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044f\n    \"product_name\",\n    \"sales\",\n    \"quantity\",\n    \"discount\",\n    \"profit\"\nFROM \"superstore\".\"stg\".\"orders\"", "relation_name": "\"superstore\".\"stg\".\"stg_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.248556Z", "completed_at": "2025-09-23T18:01:51.263231Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.264827Z", "completed_at": "2025-09-23T18:01:51.264839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017352819442749023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.superstore_dwh.calendar_dim", "compiled": true, "compiled_code": "-- \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0430\u0431\u043b\u0438\u0446\u0443-\u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c\nSELECT\n    to_char(date,'yyyymmdd')::int as dateid,\n    extract('year' from date)::int as year,\n    extract('quarter' from date)::int as quarter,\n    extract('month' from date)::int as month,\n    extract('week' from date)::int as week,\n    date::date,\n    to_char(date, 'dy') as week_day,\n    -- \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430 \u0432\u0438\u0441\u043e\u043a\u043e\u0441\u043d\u044b\u0439 \u0433\u043e\u0434\n    CASE\n        WHEN extract('day' from (date + interval '2 month - 1 day')) = 29 THEN 'leap'\n        ELSE 'not leap'\n    END as leap\nFROM generate_series(\n    date '2010-01-01',\n    date '2030-12-31',\n    interval '1 day'\n) AS t(date)", "relation_name": "\"superstore\".\"dw_test\".\"calendar_dim\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.266033Z", "completed_at": "2025-09-23T18:01:51.274843Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.278989Z", "completed_at": "2025-09-23T18:01:51.279002Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015355587005615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.superstore_dwh.customer_dim", "compiled": true, "compiled_code": "-- \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432\nSELECT\n    100 + row_number() OVER (ORDER BY \"customer_id\") as cust_id,\n    \"customer_id\",\n    \"customer_name\"\nFROM (\n    SELECT DISTINCT \"customer_id\", \"customer_name\" FROM \"superstore\".\"stg\".\"stg_orders\"\n) as unique_customers", "relation_name": "\"superstore\".\"dw_test\".\"customer_dim\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.271928Z", "completed_at": "2025-09-23T18:01:51.279857Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.281106Z", "completed_at": "2025-09-23T18:01:51.281117Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01190805435180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.superstore_dwh.geo_dim", "compiled": true, "compiled_code": "-- \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0433\u0435\u043e\u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\nSELECT\n    100 + row_number() OVER (ORDER BY \"postal_code\", \"city\", \"state\") as geo_id,\n    \"country\",\n    \"city\",\n    \"state\",\n    \"postal_code\"\nFROM (\n    SELECT DISTINCT \"country\", \"city\", \"state\", \"postal_code\" FROM \"superstore\".\"stg\".\"stg_orders\"\n) as unique_geo", "relation_name": "\"superstore\".\"dw_test\".\"geo_dim\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.275844Z", "completed_at": "2025-09-23T18:01:51.282868Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.287259Z", "completed_at": "2025-09-23T18:01:51.287273Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016154050827026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.superstore_dwh.product_dim", "compiled": true, "compiled_code": "-- \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\nSELECT\n    100 + row_number() OVER (ORDER BY \"product_id\") as prod_id,\n    \"product_id\",\n    \"product_name\",\n    \"category\",\n    \"sub_category\",\n    \"segment\"\nFROM (\n    SELECT DISTINCT \"product_id\", \"product_name\", \"category\", \"sub_category\", \"segment\" FROM \"superstore\".\"stg\".\"stg_orders\"\n) as unique_products", "relation_name": "\"superstore\".\"dw_test\".\"product_dim\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.283756Z", "completed_at": "2025-09-23T18:01:51.290297Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.307035Z", "completed_at": "2025-09-23T18:01:51.307050Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03653359413146973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.superstore_dwh.shipping_dim", "compiled": true, "compiled_code": "-- \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u0432\u0438\u0434\u043e\u0432 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438\nSELECT\n    100 + row_number() OVER (ORDER BY \"ship_mode\") as ship_id,\n    \"ship_mode\"\nFROM (\n    SELECT DISTINCT \"ship_mode\" FROM \"superstore\".\"stg\".\"stg_orders\"\n) as unique_shipping_modes", "relation_name": "\"superstore\".\"dw_test\".\"shipping_dim\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.291358Z", "completed_at": "2025-09-23T18:01:51.309250Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.316253Z", "completed_at": "2025-09-23T18:01:51.316267Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027735471725463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.not_null_geo_dim_geo_id.e39e2b473d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geo_id\nfrom \"superstore\".\"dw_test\".\"geo_dim\"\nwhere geo_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.303296Z", "completed_at": "2025-09-23T18:01:51.308677Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.319569Z", "completed_at": "2025-09-23T18:01:51.319610Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.033026695251464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.not_null_customer_dim_cust_id.cd86607a42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cust_id\nfrom \"superstore\".\"dw_test\".\"customer_dim\"\nwhere cust_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.310379Z", "completed_at": "2025-09-23T18:01:51.318248Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.320821Z", "completed_at": "2025-09-23T18:01:51.320831Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03114628791809082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.unique_customer_dim_cust_id.4713a3a721", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cust_id as unique_field,\n    count(*) as n_records\n\nfrom \"superstore\".\"dw_test\".\"customer_dim\"\nwhere cust_id is not null\ngroup by cust_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.322546Z", "completed_at": "2025-09-23T18:01:51.331952Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.334115Z", "completed_at": "2025-09-23T18:01:51.334128Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01666116714477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.not_null_product_dim_prod_id.a7c013c688", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prod_id\nfrom \"superstore\".\"dw_test\".\"product_dim\"\nwhere prod_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.326892Z", "completed_at": "2025-09-23T18:01:51.333105Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.339027Z", "completed_at": "2025-09-23T18:01:51.339042Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020124197006225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.unique_geo_dim_geo_id.1203f3ade2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    geo_id as unique_field,\n    count(*) as n_records\n\nfrom \"superstore\".\"dw_test\".\"geo_dim\"\nwhere geo_id is not null\ngroup by geo_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.339928Z", "completed_at": "2025-09-23T18:01:51.346820Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.349210Z", "completed_at": "2025-09-23T18:01:51.349223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01812291145324707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.superstore_dwh.sales_fact", "compiled": true, "compiled_code": "-- \u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u0444\u0430\u043a\u0442\u043e\u0432, \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u044f \u0432\u0441\u0435 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f\nSELECT\n    -- \u0421\u0443\u0440\u0440\u043e\u0433\u0430\u0442\u043d\u044b\u0435 \u043a\u043b\u044e\u0447\u0438 \u0438\u0437 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439\n    cd.cust_id,\n    pd.prod_id,\n    sd.ship_id,\n    gd.geo_id,\n    -- \u041a\u043b\u044e\u0447\u0438 \u0434\u043b\u044f \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044f\n    to_char(o.order_date, 'yyyymmdd')::int AS order_date_id,\n    to_char(o.ship_date, 'yyyymmdd')::int AS ship_date_id,\n    -- \u0411\u0438\u0437\u043d\u0435\u0441-\u043a\u043b\u044e\u0447 \u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0438\n    o.order_id,\n    o.sales,\n    o.profit,\n    o.quantity,\n    o.discount\nFROM \"superstore\".\"stg\".\"stg_orders\" AS o\nLEFT JOIN \"superstore\".\"dw_test\".\"customer_dim\" AS cd ON o.customer_id = cd.customer_id\nLEFT JOIN \"superstore\".\"dw_test\".\"product_dim\" AS pd ON o.product_id = pd.product_id\nLEFT JOIN \"superstore\".\"dw_test\".\"shipping_dim\" AS sd ON o.ship_mode = sd.ship_mode\nLEFT JOIN \"superstore\".\"dw_test\".\"geo_dim\" AS gd ON o.postal_code = gd.postal_code AND o.city = gd.city AND o.state = gd.state", "relation_name": "\"superstore\".\"dw_test\".\"sales_fact\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.334964Z", "completed_at": "2025-09-23T18:01:51.348030Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.358749Z", "completed_at": "2025-09-23T18:01:51.358764Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0282895565032959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.unique_product_dim_prod_id.c4c4789a7c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    prod_id as unique_field,\n    count(*) as n_records\n\nfrom \"superstore\".\"dw_test\".\"product_dim\"\nwhere prod_id is not null\ngroup by prod_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.354404Z", "completed_at": "2025-09-23T18:01:51.361350Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.362275Z", "completed_at": "2025-09-23T18:01:51.362291Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01620769500732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.not_null_shipping_dim_ship_id.0454d0178d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ship_id\nfrom \"superstore\".\"dw_test\".\"shipping_dim\"\nwhere ship_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.350438Z", "completed_at": "2025-09-23T18:01:51.360479Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.363189Z", "completed_at": "2025-09-23T18:01:51.363202Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01593184471130371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.unique_shipping_dim_ship_id.98eb2c08a7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ship_id as unique_field,\n    count(*) as n_records\n\nfrom \"superstore\".\"dw_test\".\"shipping_dim\"\nwhere ship_id is not null\ngroup by ship_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-23T18:01:51.365490Z", "completed_at": "2025-09-23T18:01:51.372890Z"}, {"name": "execute", "started_at": "2025-09-23T18:01:51.373469Z", "completed_at": "2025-09-23T18:01:51.373481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009624004364013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.superstore_dwh.relationships_sales_fact_cust_id__cust_id__ref_customer_dim_.2243272279", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select cust_id as from_field\n    from \"superstore\".\"dw_test\".\"sales_fact\"\n    where cust_id is not null\n),\n\nparent as (\n    select cust_id as to_field\n    from \"superstore\".\"dw_test\".\"customer_dim\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.299593448638916, "args": {"quiet": false, "send_anonymous_usage_stats": true, "invocation_command": "dbt docs generate", "empty_catalog": false, "show_resource_report": false, "printer_width": 80, "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "introspect": true, "compile": true, "cache_selected_only": false, "show_all_deprecations": false, "version_check": true, "upload_to_artifacts_ingest_api": false, "static_parser": true, "log_format_file": "debug", "validate_macro_args": false, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "defer": false, "macro_debugging": false, "select": [], "exclude": [], "require_resource_names_without_spaces": true, "log_file_max_bytes": 10485760, "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_more_unrendered_values": false, "favor_state": false, "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": true, "require_generic_test_arguments_property": true, "project_dir": "/home/dev/Downloads/pde_magistr/superstore_dwh", "skip_nodes_if_on_run_start_fails": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "write_json": true, "strict_mode": false, "log_level_file": "debug", "populate_cache": true, "print": true, "partial_parse": true, "vars": {}, "indirect_selection": "eager", "partial_parse_file_diff": true, "which": "generate", "profiles_dir": "/home/dev/.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "use_fast_test_edges": false, "log_path": "/home/dev/Downloads/pde_magistr/superstore_dwh/logs", "log_level": "info", "static": false, "use_colors_file": true, "use_colors": true}}